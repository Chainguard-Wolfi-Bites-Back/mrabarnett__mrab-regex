pipelines:
  default:
    - parallel:
      - step:
          image: quay.io/pypa/manylinux2010_x86_64
          caches:
            - pip
          script:
            - for py in 27 36 37 38; do echo building Python${py} wheel; /opt/python/${py}*/bin/pip wheel .; done
            - auditwheel repair *.whl -w wheelhouse
            - pip install twine
            - twine upload --skip-existing --reposity-url https://test.pypi.org/legacy/ -u $PYPI_USER -p $PYPI_PASS wheelhouse/*
      - step:
          image: quay.io/pypa/manylinux2010_i686
          caches:
            - pip
          script:
            - for py in 27 36 37 38; do echo building Python${py} wheel; linux32 /opt/python/${py}*/bin/pip wheel .; done
            - auditwheel repair *.whl -w wheelhouse
            - pip install twine
            - twine upload --skip-existing --reposity-url https://test.pypi.org/legacy/ -u $PYPI_USER -p $PYPI_PASS wheelhouse/*